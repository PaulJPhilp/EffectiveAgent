{
  "id": "5c8a362e-fe05-48d8-89f1-e3c4a46f7247",
  "sourceProfileId": "15956651-acea-48ae-bca2-1e70aa063866",
  "content": "```python\nimport json\nimport re\nfrom datetime import datetime\n\ndef normalize_profile(profile):\n    \"\"\"Normalizes a professional profile according to the guidelines.\"\"\"\n\n    normalization_notes = []\n    normalized_profile = profile.copy()\n\n    # 1. Company Names\n    def normalize_company_name(company_name):\n        if not company_name:\n            return company_name\n\n        company_name = \" \".join(company_name.split())  # Remove duplicate spaces\n        company_name = re.sub(r'\\s+', ' ', company_name).strip() #remove extra spaces\n        \n        # Handle capitalization\n        if company_name.upper() == company_name and company_name not in [\"ACME\", \"LUME\"]:\n            company_name = company_name.title()\n        else:\n            company_name = company_name.title()\n\n        # Standardize common variations\n        company_name = company_name.replace(\"Inc.\", \"Incorporated\")\n        company_name = company_name.replace(\"Corp.\", \"Corp\")\n        company_name = company_name.replace(\"Llc.\", \"LLC\")\n        company_name = company_name.replace(\"L.L.C.\", \"LLC\")\n        company_name = company_name.replace(\"L. L. C.\", \"LLC\")\n        company_name = company_name.replace(\"Gmbh\", \"GmbH\")\n        company_name = company_name.replace(\"Pty Ltd\", \"Pty Ltd\") #Preserve case\n        company_name = company_name.replace(\"Pte Ltd\", \"Pte Ltd\") #Preserve case\n        company_name = company_name.replace(\"Pte. Ltd.\", \"Pte Ltd\") #Preserve case\n        company_name = company_name.replace(\"Pty. Ltd.\", \"Pty Ltd\") #Preserve case\n        company_name = company_name.replace(\"S.A.\", \"SA\")\n        company_name = company_name.replace(\"S. A.\", \"SA\")\n        company_name = company_name.replace(\"S. A\", \"SA\")\n        company_name = company_name.replace(\"S A\", \"SA\")\n        company_name = company_name.replace(\"Co.\", \"Co\")\n        company_name = company_name.replace(\" & \", \" & \")\n        company_name = company_name.replace(\" And \", \" & \")\n        company_name = company_name.replace(\"Self Employed\", \"Self-Employed\")\n        company_name = company_name.replace(\"Self employed\", \"Self-Employed\")\n        company_name = company_name.replace(\"Self-employed\", \"Self-Employed\")\n        company_name = company_name.replace(\"Fleishmanhillard\", \"Fleishman-Hillard\")\n        company_name = company_name.replace(\"Lume Studios\", \"LUME Studios\") #Preserve case\n        \n        return company_name\n\n    # 2. Job Titles\n    def normalize_job_title(job_title):\n        if not job_title:\n            return job_title\n\n        job_title = job_title.replace(\"Sr.\", \"Senior\")\n        job_title = job_title.replace(\"Mgr\", \"Manager\")\n        job_title = job_title.replace(\"Proj.\", \"Project\")\n        job_title = job_title.replace(\"Mktg\", \"Marketing\")\n        job_title = job_title.replace(\"Assoc.\", \"Associate\")\n        job_title = job_title.replace(\"Asst.\", \"Assistant\")\n        job_title = job_title.replace(\"Engr.\", \"Engineer\")\n        job_title = job_title.replace(\"Dev.\", \"Development\")\n        job_title = job_title.replace(\"Dir.\", \"Director\")\n        job_title = job_title.replace(\"VP\", \"Vice President\")\n        job_title = job_title.replace(\"CFO\", \"Chief Financial Officer\")\n        job_title = job_title.replace(\"CEO\", \"Chief Executive Officer\")\n        job_title = job_title.replace(\"COO\", \"Chief Operating Officer\")\n        job_title = job_title.replace(\"CTO\", \"Chief Technology Officer\")\n        job_title = job_title.replace(\"HR\", \"Human Resources\")\n        job_title = job_title.replace(\"PM\", \"Project Manager\")\n        job_title = job_title.replace(\"QA\", \"Quality Assurance\")\n        job_title = job_title.replace(\"UX\", \"User Experience\")\n        job_title = job_title.replace(\"UI\", \"User Interface\")\n        job_title = job_title.replace(\"AI\", \"Artificial Intelligence\")\n        job_title = job_title.replace(\"ML\", \"Machine Learning\")\n        job_title = job_title.replace(\"Data Scientist\", \"Data Scientist\")\n        job_title = job_title.replace(\"Data Analyst\", \"Data Analyst\")\n        job_title = job_title.replace(\"Data Engineer\", \"Data Engineer\")\n        job_title = job_title.replace(\"Software Engineer\", \"Software Engineer\")\n        job_title = job_title.replace(\"Software Developer\", \"Software Developer\")\n        job_title = job_title.replace(\"Full Stack Developer\", \"Full Stack Developer\")\n        job_title = job_title.replace(\"Front End Developer\", \"Front End Developer\")\n        job_title = job_title.replace(\"Back End Developer\", \"Back End Developer\")\n        job_title = job_title.replace(\"Cloud Engineer\", \"Cloud Engineer\")\n        job_title = job_title.replace(\"DevOps Engineer\", \"DevOps Engineer\")\n        job_title = job_title.replace(\"Security Engineer\", \"Security Engineer\")\n        job_title = job_title.replace(\"Network Engineer\", \"Network Engineer\")\n        job_title = job_title.replace(\"System Administrator\", \"System Administrator\")\n        job_title = job_title.replace(\"Database Administrator\", \"Database Administrator\")\n        job_title = job_title.replace(\"Business Analyst\", \"Business Analyst\")\n        job_title = job_title.replace(\"Product Manager\", \"Product Manager\")\n        job_title = job_title.replace(\"Product Owner\", \"Product Owner\")\n        job_title = job_title.replace(\"Scrum Master\", \"Scrum Master\")\n        job_title = job_title.replace(\"Agile Coach\", \"Agile Coach\")\n        job_title = job_title.replace(\"Technical Lead\", \"Technical Lead\")\n        job_title = job_title.replace(\"Team Lead\", \"Team Lead\")\n        job_title = job_title.replace(\"Sales Manager\", \"Sales Manager\")\n        job_title = job_title.replace(\"Account Manager\", \"Account Manager\")\n        job_title = job_title.replace(\"Customer Service Representative\", \"Customer Service Representative\")\n        job_title = job_title.replace(\"Customer Support Specialist\", \"Customer Support Specialist\")\n        job_title = job_title.replace(\"Marketing Specialist\", \"Marketing Specialist\")\n        job_title = job_title.replace(\"Marketing Coordinator\", \"Marketing Coordinator\")\n        job_title = job_title.replace(\"Marketing Analyst\", \"Marketing Analyst\")\n        job_title = job_title.replace(\"Marketing Manager\", \"Marketing Manager\")\n        job_title = job_title.replace(\"Marketing Director\", \"Marketing Director\")\n        job_title = job_title.replace(\"Marketing Vice President\", \"Marketing Vice President\")\n        job_title = job_title.replace(\"Marketing Chief\", \"Marketing Chief\")\n        job_title = job_title.replace(\"Financial Analyst\", \"Financial Analyst\")\n        job_title = job_title.replace(\"Financial Manager\", \"Financial Manager\")\n        job_title = job_title.replace(\"Financial Director\", \"Financial Director\")\n        job_title = job_title.replace(\"Financial Vice President\", \"Financial Vice President\")\n        job_title = job_title.replace(\"Financial Chief\", \"Financial Chief\")\n        job_title = job_title.replace(\"Human Resources Manager\", \"Human Resources Manager\")\n        job_title = job_title.replace(\"Human Resources Director\", \"Human Resources Director\")\n        job_title = job_title.replace(\"Human Resources Vice President\", \"Human Resources Vice President\")\n        job_title = job_title.replace(\"Human Resources Chief\", \"Human Resources Chief\")\n        job_title = job_title.replace(\"Operations Manager\", \"Operations Manager\")\n        job_title = job_title.replace(\"Operations Director\", \"Operations Director\")\n        job_title = job_title.replace(\"Operations Vice President\", \"Operations Vice President\")\n        job_title = job_title.replace(\"Operations Chief\", \"Operations Chief\")\n        job_title = job_title.replace(\"Sales Representative\", \"Sales Representative\")\n        job_title = job_title.replace(\"Sales Director\", \"Sales Director\")\n        job_title = job_title.replace(\"Sales Vice President\", \"Sales Vice President\")\n        job_title = job_title.replace(\"Sales Chief\", \"Sales Chief\")\n        job_title = job_title.replace(\"Business Development Manager\", \"Business Development Manager\")\n        job_title = job_title.replace(\"Business Development Director\", \"Business Development Director\")\n        job_title = job_title.replace(\"Business Development Vice President\", \"Business Development Vice President\")\n        job_title = job_title.replace(\"Business Development Chief\", \"Business Development Chief\")\n        job_title = job_title.replace(\"Project Coordinator\", \"Project Coordinator\")\n        job_title = job_title.replace(\"Project Director\", \"Project Director\")\n        job_title = job_title.replace(\"Project Vice President\", \"Project Vice President\")\n        job_title = job_title.replace(\"Project Chief\", \"Project Chief\")\n        job_title = job_title.replace(\"Quality Assurance Analyst\", \"Quality Assurance Analyst\")\n        job_title = job_title.replace(\"Quality Assurance Engineer\", \"Quality Assurance Engineer\")\n        job_title = job_title.replace(\"Quality Assurance Manager\", \"Quality Assurance Manager\")\n        job_title = job_title.replace(\"Quality Assurance Director\", \"Quality Assurance Director\")\n        job_title = job_title.replace(\"Quality Assurance Vice President\", \"Quality Assurance Vice President\")\n        job_title = job_title.replace(\"Quality Assurance Chief\", \"Quality Assurance Chief\")\n        job_title = job_title.replace(\"User Experience Designer\", \"User Experience Designer\")\n        job_title = job_title.replace(\"User Experience Researcher\", \"User Experience Researcher\")\n        job_title = job_title.replace(\"User Experience Manager\", \"User Experience Manager\")\n        job_title = job_title.replace(\"User Experience Director\", \"User Experience Director\")\n        job_title = job_title.replace(\"User Experience Vice President\", \"User Experience Vice President\")\n        job_title = job_title.replace(\"User Experience Chief\", \"User Experience Chief\")\n        job_title = job_title.replace(\"User Interface Designer\", \"User Interface Designer\")\n        job_title = job_title.replace(\"User Interface Developer\", \"User Interface Developer\")\n        job_title = job_title.replace(\"User Interface Manager\", \"User Interface Manager\")\n        job_title = job_title.replace(\"User Interface Director\", \"User Interface Director\")\n        job_title = job_title.replace(\"User Interface Vice President\", \"User Interface Vice President\")\n        job_title = job_title.replace(\"User Interface Chief\", \"User Interface Chief\")\n        job_title = job_title.replace(\"Artificial Intelligence Engineer\", \"Artificial Intelligence Engineer\")\n        job_title = job_title.replace(\"Artificial Intelligence Researcher\", \"Artificial Intelligence Researcher\")\n        job_title = job_title.replace(\"Artificial Intelligence Manager\", \"Artificial Intelligence Manager\")\n        job_title = job_title.replace(\"Artificial Intelligence Director\", \"Artificial Intelligence Director\")\n        job_title = job_title.replace(\"Artificial Intelligence Vice President\", \"Artificial Intelligence Vice President\")\n        job_title = job_title.replace(\"Artificial Intelligence Chief\", \"Artificial Intelligence Chief\")\n        job_title = job_title.replace(\"Machine Learning Engineer\", \"Machine Learning Engineer\")\n        job_title = job_title.replace(\"Machine Learning Researcher\", \"Machine Learning Researcher\")\n        job_title = job_title.replace(\"Machine Learning Manager\", \"Machine Learning Manager\")\n        job_title = job_title.replace(\"Machine Learning Director\", \"Machine Learning Director\")\n        job_title = job_title.replace(\"Machine Learning Vice President\", \"Machine Learning Vice President\")\n        job_title = job_title.replace(\"Machine Learning Chief\", \"Machine Learning Chief\")\n        job_title = job_title.replace(\"Data Science Manager\", \"Data Science Manager\")\n        job_title = job_title.replace(\"Data Science Director\", \"Data Science Director\")\n        job_title = job_title.replace(\"Data Science Vice President\", \"Data Science Vice President\")\n        job_title = job_title.replace(\"Data Science Chief\", \"Data Science Chief\")\n        job_title = job_title.replace(\"Data Engineering Manager\", \"Data Engineering Manager\")\n        job_title = job_title.replace(\"Data Engineering Director\", \"Data Engineering Director\")\n        job_title = job_title.replace(\"Data Engineering Vice President\", \"Data Engineering Vice President\")\n        job_title = job_title.replace(\"Data Engineering Chief\", \"Data Engineering Chief\")\n        job_title = job_title.replace(\"Software Engineering Manager\", \"Software Engineering Manager\")\n        job_title = job_title.replace(\"Software Engineering Director\", \"Software Engineering Director\")\n        job_title = job_title.replace(\"Software Engineering Vice President\", \"Software Engineering Vice President\")\n        job_title = job_title.replace(\"Software Engineering Chief\", \"Software Engineering Chief\")\n        job_title = job_title.replace(\"Cloud Engineering Manager\", \"Cloud Engineering Manager\")\n        job_title = job_title.replace(\"Cloud Engineering Director\", \"Cloud Engineering Director\")\n        job_title = job_title.replace(\"Cloud Engineering Vice President\", \"Cloud Engineering Vice President\")\n        job_title = job_title.replace(\"Cloud Engineering Chief\", \"Cloud Engineering Chief\")\n        job_title = job_title.replace(\"DevOps Engineering Manager\", \"DevOps Engineering Manager\")\n        job_title = job_title.replace(\"DevOps Engineering Director\", \"DevOps Engineering Director\")\n        job_title = job_title.replace(\"DevOps Engineering Vice President\", \"DevOps Engineering Vice President\")\n        job_title = job_title.replace(\"DevOps Engineering Chief\", \"DevOps Engineering Chief\")\n        job_title = job_title.replace(\"Security Engineering Manager\", \"Security Engineering Manager\")\n        job_title = job_title.replace(\"Security Engineering Director\", \"Security Engineering Director\")\n        job_title = job_title.replace(\"Security Engineering Vice President\", \"Security Engineering Vice President\")\n        job_title = job_title.replace(\"Security Engineering Chief\", \"Security Engineering Chief\")\n        job_title = job_title.replace(\"Network Engineering Manager\", \"Network Engineering Manager\")\n        job_title = job_title.replace(\"Network Engineering Director\", \"Network Engineering Director\")\n        job_title = job_title.replace(\"Network Engineering Vice President\", \"Network Engineering Vice President\")\n        job_title = job_title.replace(\"Network Engineering Chief\", \"Network Engineering Chief\")\n        job_title = job_title.replace(\"System Administration Manager\", \"System Administration Manager\")\n        job_title = job_title.replace(\"System Administration Director\", \"System Administration Director\")\n        job_title = job_title.replace(\"System Administration Vice President\", \"System Administration Vice President\")\n        job_title = job_title.replace(\"System Administration Chief\", \"System Administration Chief\")\n        job_title = job_title.replace(\"Database Administration Manager\", \"Database Administration Manager\")\n        job_title = job_title.replace(\"Database Administration Director\", \"Database Administration Director\")\n        job_title = job_title.replace(\"Database Administration Vice President\", \"Database Administration Vice President\")\n        job_title = job_title.replace(\"Database Administration Chief\", \"Database Administration Chief\")\n        job_title = job_title.replace(\"Business Analysis Manager\", \"Business Analysis Manager\")\n        job_title = job_title.replace(\"Business Analysis Director\", \"Business Analysis Director\")\n        job_title = job_title.replace(\"Business Analysis Vice President\", \"Business Analysis Vice President\")\n        job_title = job_title.replace(\"Business Analysis Chief\", \"Business Analysis Chief\")\n        job_title = job_title.replace(\"Product Management Manager\", \"Product Management Manager\")\n        job_title = job_title.replace(\"Product Management Director\", \"Product Management Director\")\n        job_title = job_title.replace(\"Product Management Vice President\", \"Product Management Vice President\")\n        job_title = job_title.replace(\"Product Management Chief\", \"Product Management Chief\")\n        job_title = job_title.replace(\"Scrum Master Manager\", \"Scrum Master Manager\")\n        job_title = job_title.replace(\"Scrum Master Director\", \"Scrum Master Director\")\n        job_title = job_title.replace(\"Scrum Master Vice President\", \"Scrum Master Vice President\")\n        job_title = job_title.replace(\"Scrum Master Chief\", \"Scrum Master Chief\")\n        job_title = job_title.replace(\"Agile Coach Manager\", \"Agile Coach Manager\")\n        job_title = job_title.replace(\"Agile Coach Director\", \"Agile Coach Director\")\n        job_title = job_title.replace(\"Agile Coach Vice President\", \"Agile Coach Vice President\")\n        job_title = job_title.replace(\"Agile Coach Chief\", \"Agile Coach Chief\")\n        job_title = job_title.replace(\"Technical Lead Manager\", \"Technical Lead Manager\")\n        job_title = job_title.replace(\"Technical Lead Director\", \"Technical Lead Director\")\n        job_title = job_title.replace(\"Technical Lead Vice President\", \"Technical Lead Vice President\")\n        job_title = job_title.replace(\"Technical Lead Chief\", \"Technical Lead Chief\")\n        job_title = job_title.replace(\"Team Lead Manager\", \"Team Lead Manager\")\n        job_title = job_title.replace(\"Team Lead Director\", \"Team Lead Director\")\n        job_title = job_title.replace(\"Team Lead Vice President\", \"Team Lead Vice President\")\n        job_title = job_title.replace(\"Team Lead Chief\", \"Team Lead Chief\")\n        job_title = job_title.replace(\"Sales Management Manager\", \"Sales Management Manager\")\n        job_title = job_title.replace(\"Sales Management Director\", \"Sales Management Director\")\n        job_title = job_title.replace(\"Sales Management Vice President\", \"Sales Management Vice President\")\n        job_title = job_title.replace(\"Sales Management Chief\", \"Sales Management Chief\")\n        job_title = job_title.replace(\"Account Management Manager\", \"Account Management Manager\")\n        job_title = job_title.replace(\"Account Management Director\", \"Account Management Director\")\n        job_title = job_title.replace(\"Account Management Vice President\", \"Account Management Vice President\")\n        job_title = job_title.replace(\"Account Management Chief\", \"Account Management Chief\")\n        job_title = job_title.replace(\"Customer Service Management Manager\", \"Customer Service Management Manager\")\n        job_title = job_title.replace(\"Customer Service Management Director\", \"Customer Service Management Director\")\n        job_title = job_title.replace(\"Customer Service Management Vice President\", \"Customer Service Management Vice President\")\n        job_title = job_title.replace(\"Customer Service Management Chief\", \"Customer Service Management Chief\")\n        job_title = job_title.replace(\"Customer Support Management Manager\", \"Customer Support Management Manager\")\n        job_title = job_title.replace(\"Customer Support Management Director\", \"Customer Support Management Director\")\n        job_title = job_title.replace(\"Customer Support Management Vice President\", \"Customer Support Management Vice President\")\n        job_title = job_title.replace(\"Customer Support Management Chief\", \"Customer Support Management Chief\")\n\n        return job_title\n\n    # 3. Skills\n    def normalize_skill(skill):\n        if not skill:\n            return skill\n\n        skill = skill.strip()\n        skill = skill.replace(\"Salesforce.com\", \"Salesforce\")\n        skill = skill.replace(\"Digital Mktg\", \"Digital Marketing\")\n        skill = skill.replace(\"Class Management\", \"Classroom Management\")\n        return skill\n\n    # 4. Locations\n    def normalize_location(location):\n        if not location:\n            return location\n\n        location = location.replace(\"NYC, New York\", \"New York, New York, United States\")\n        location = location.replace(\"Dallas, TX\", \"Dallas, Texas, United States\")\n        location = location.replace(\"Austin, Texas Area\", \"Austin, Texas, United States\")\n        return location\n\n    # 5. Dates\n    def normalize_date(date_string):\n        if not date_string:\n            return date_string\n\n        date_string = date_string.strip()\n        if date_string.lower() == \"present\":\n            return \"Present\"\n\n        try:\n            # Attempt to parse various date formats\n            date_obj = None\n            for fmt in (\"%B %Y\", \"%b %Y\", \"%m/%Y\", \"%Y-%m-%d\", \"%Y-%m\"):\n                try:\n                    date_obj = datetime.strptime(date_string, fmt)\n                    break\n                except ValueError:\n                    continue\n\n            if date_obj:\n                return date_obj.strftime(\"%Y-%m\")  # Standardize to YYYY-MM\n            else:\n                return date_string  # Return original if parsing fails\n        except ValueError:\n            return date_string\n\n    # Normalize top-level fields\n    if \"title\" in normalized_profile:\n        original_title = normalized_profile[\"title\"]\n        normalized_profile[\"title\"] = normalize_job_title(normalized_profile[\"title\"])\n        if original_title != normalized_profile[\"title\"]:\n            normalization_notes.append(f\"Standardized job title: '{original_title}' to '{normalized_profile['title']}'\")\n\n    if \"location\" in normalized_profile:\n        original_location = normalized_profile[\"location\"]\n        normalized_profile[\"location\"] = normalize_location(normalized_profile[\"location\"])\n        if original_location != normalized_profile[\"location\"]:\n            normalization_notes.append(f\"Standardized location: '{original_location}' to '{normalized_profile['location']}'\")\n\n    if \"key_skills\" in normalized_profile:\n        original_skills = normalized_profile[\"key_skills\"]\n        normalized_profile[\"key_skills\"] = [normalize_skill(skill) for skill in normalized_profile[\"key_skills\"]]\n        if original_skills != normalized_profile[\"key_skills\"]:\n            normalization_notes.append(f\"Standardized skills: '{original_skills}' to '{normalized_profile['key_skills']}'\")\n\n    # Normalize experience entries\n    if \"experience\" in normalized_profile:\n        for exp in normalized_profile[\"experience\"]:\n            if \"company\" in exp:\n                original_company = exp[\"company\"]\n                exp[\"company\"] = normalize_company_name(exp[\"company\"])\n                if original_company != exp[\"company\"]:\n                    normalization_notes.append(f\"Standardized company name: '{original_company}' to '{exp['company']}'\")\n\n            if \"title\" in exp:\n                original_title = exp[\"title\"]\n                exp[\"title\"] = normalize_job_title(exp[\"title\"])\n                if original_title != exp[\"title\"]:\n                    normalization_notes.append(f\"Standardized job title: '{original_title}' to '{exp['title']}'\")\n\n            if \"location\" in exp:\n                original_location = exp[\"location\"]\n                exp[\"location\"] = normalize_location(exp[\"location\"])\n                if original_location != exp[\"location\"]:\n                    normalization_notes.append(f\"Standardized location: '{original_location}' to '{exp['location']}'\")\n\n            if \"duration\" in exp:\n                if \"start_date\" in exp[\"duration\"]:\n                    original_start_date = exp[\"duration\"][\"start_date\"]\n                    exp[\"duration\"][\"start_date\"] = normalize_date(exp[\"duration\"][\"start_date\"])\n                    if original_start_date != exp[\"duration\"][\"start_date\"]:\n                        normalization_notes.append(f\"Standardized start date: '{original_start_date}' to '{exp['duration']['start_date']}'\")\n\n                if \"end_date\" in exp[\"duration\"]:\n                    original_end_date = exp[\"duration\"][\"end_date\"]\n                    exp[\"duration\"][\"end_date\"] = normalize_date(exp[\"duration\"][\"end_date\"])\n                    if original_end_date != exp[\"duration\"][\"end_date\"]:\n                        normalization_notes.append(f\"Standardized end date: '{original_end_date}' to '{exp['duration']['end_date']}'\")\n\n    # Add normalization notes if any changes were made\n    if normalization_notes:\n        normalized_profile[\"normalization_notes\"] = \"; \".join(normalization_notes)\n\n    return normalized_profile\n```",
  "normalizedFields": {}
}